# GitHub Actions å·¥ä½œæµé…ç½®
# æ–‡ä»¶ä½ç½®ï¼š.github/workflows/ci.yml

name: CI Pipeline  # å·¥ä½œæµåç§°

# è§¦å‘æ¡ä»¶ï¼šä»€ä¹ˆæ—¶å€™è¿è¡Œè¿™ä¸ªå·¥ä½œæµ
on:
  push:
    branches: [ master, main ]  # æ¨é€åˆ° master æˆ– main æ—¶è§¦å‘
  pull_request:
    branches: [ master, main ]  # PR åˆ° master æˆ– main æ—¶è§¦å‘

# ä»»åŠ¡å®šä¹‰
jobs:
  # ä»»åŠ¡1ï¼šæ£€æŸ¥ä»£ç 
  check:
    name: Check Files  # ä»»åŠ¡åç§°
    runs-on: ubuntu-latest  # è¿è¡Œç¯å¢ƒ

    steps:
      # æ­¥éª¤1ï¼šæ£€å‡ºä»£ç 
      - name: Checkout code
        uses: actions/checkout@v4

      # æ­¥éª¤2ï¼šæ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨
      - name: List files
        run: |
          echo "ğŸ“ é¡¹ç›®æ–‡ä»¶åˆ—è¡¨ï¼š"
          ls -la
          echo ""
          echo "ğŸ“„ README å†…å®¹ï¼š"
          cat README.md

      # æ­¥éª¤3ï¼šæ£€æŸ¥å¿…è¦æ–‡ä»¶æ˜¯å¦å­˜åœ¨
      - name: Check required files
        run: |
          echo "ğŸ” æ£€æŸ¥å¿…è¦æ–‡ä»¶..."

          if [ -f "README.md" ]; then
            echo "âœ… README.md å­˜åœ¨"
          else
            echo "âŒ README.md ä¸å­˜åœ¨"
            exit 1
          fi

          echo "ğŸ‰ æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼"

  # ä»»åŠ¡2ï¼šç»Ÿè®¡ä¿¡æ¯
  stats:
    name: Project Stats
    runs-on: ubuntu-latest
    needs: check  # ä¾èµ– check ä»»åŠ¡å®Œæˆ

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Count lines
        run: |
          echo "ğŸ“Š é¡¹ç›®ç»Ÿè®¡ï¼š"
          echo "æ–‡ä»¶æ•°é‡: $(find . -type f | wc -l)"
          echo "Markdown æ–‡ä»¶: $(find . -name '*.md' | wc -l)"
          echo "æ€»è¡Œæ•°: $(find . -name '*.md' -exec cat {} \; | wc -l)"
